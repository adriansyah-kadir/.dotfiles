/// <reference path="../../typings/vscode.proposed.notebookDocumentEvents.d.ts" />
import * as vscode from 'vscode';
import * as proto from 'vscode-languageserver-protocol';
import { NotebookCellTextDocumentFilter } from 'vscode-languageserver-protocol';
import { DynamicFeature, BaseLanguageClient, RegistrationData } from './client';
export declare type NotebookDocumentChangeEvent = {
    /**
     * The notebook document
     */
    notebook: vscode.NotebookDocument;
    /**
     * The changed meta data if any.
     */
    metadata?: {
        [key: string]: any;
    };
    /**
     * Changes to cells.
     */
    cells?: {
        /**
        * Changes to the cell structure to add or
        * remove cells.
        */
        structure?: {
            /**
             * The change to the cell array.
             */
            array: {
                start: number;
                deleteCount: number;
                cells?: vscode.NotebookCell[];
            };
            /**
             * Additional opened cell text documents.
             */
            didOpen?: vscode.NotebookCell[];
            /**
             * Additional closed cell text documents.
             */
            didClose?: vscode.NotebookCell[];
        };
        /**
         * Changes to notebook cells properties like its
         * kind or metadata.
         */
        data?: vscode.NotebookCell[];
        /**
         * Changes to the text content of notebook cells.
         */
        textContent?: vscode.TextDocumentChangeEvent[];
    };
};
export declare type NotebookDocumentMiddleware = {
    notebooks?: {
        didOpen?: (this: void, notebookDocument: vscode.NotebookDocument, cells: vscode.NotebookCell[], next: (this: void, notebookDocument: vscode.NotebookDocument, cells: vscode.NotebookCell[]) => Promise<void>) => Promise<void>;
        didSave?: (this: void, notebookDocument: vscode.NotebookDocument, next: (this: void, notebookDocument: vscode.NotebookDocument) => Promise<void>) => Promise<void>;
        didChange?: (this: void, event: NotebookDocumentChangeEvent, next: (this: void, event: NotebookDocumentChangeEvent) => Promise<void>) => Promise<void>;
        didClose?: (this: void, notebookDocument: vscode.NotebookDocument, cells: vscode.NotebookCell[], next: (this: void, notebookDocument: vscode.NotebookDocument, cells: vscode.NotebookCell[]) => Promise<void>) => Promise<void>;
    };
};
export interface NotebookDocumentSyncFeatureShape {
    mode: 'notebook';
    sendDidOpenNotebookDocument(notebookDocument: vscode.NotebookDocument): Promise<void>;
    sendDidSaveNotebookDocument(notebookDocument: vscode.NotebookDocument): Promise<void>;
    sendDidChangeNotebookDocument(event: NotebookDocumentChangeEvent): Promise<void>;
    sendDidCloseNotebookDocument(notebookDocument: vscode.NotebookDocument): Promise<void>;
}
export declare type $NotebookCellTextDocumentFilter = NotebookCellTextDocumentFilter & {
    sync: true;
};
export interface NotebookCellTextDocumentSyncFeatureShape {
    mode: 'cellContent';
    sendDidOpenTextDocument(textDocument: vscode.TextDocument): Promise<void>;
    sendDidChangeTextDocument(event: vscode.TextDocumentChangeEvent): Promise<void>;
    sendDidCloseTextDocument(textDocument: vscode.TextDocument): Promise<void>;
}
export interface NotebookDocumentProviderFeature {
    getProvider(notebookCell: vscode.NotebookCell): NotebookCellTextDocumentSyncFeatureShape | NotebookDocumentSyncFeatureShape | undefined;
}
export declare class NotebookDocumentSyncFeature implements DynamicFeature<proto.Proposed.NotebookDocumentSyncRegistrationOptions>, NotebookDocumentProviderFeature {
    static readonly CellScheme: string;
    private readonly client;
    private readonly registrations;
    constructor(client: BaseLanguageClient);
    readonly registrationType: proto.RegistrationType<proto.Proposed.NotebookDocumentSyncRegistrationOptions>;
    fillClientCapabilities(capabilities: proto.ClientCapabilities & proto.Proposed.$NotebookDocumentClientCapabilities): void;
    initialize(capabilities: proto.ServerCapabilities<any> & proto.Proposed.$NotebookDocumentSyncServerCapabilities): void;
    register(data: RegistrationData<proto.Proposed.NotebookDocumentSyncRegistrationOptions>): void;
    unregister(id: string): void;
    dispose(): void;
    getProvider(notebookCell: vscode.NotebookCell): NotebookCellTextDocumentSyncFeatureShape | NotebookDocumentSyncFeatureShape | undefined;
    private findNotebookDocumentAndCell;
}
